@{
    ViewBag.Title = "LATATrax | Dispatch";
}

@section scripts{
    @Scripts.Render("~/bundles/KOAndSignarlR")
    <script src="@Url.Content("~/signalr/hubs")" type="text/javascript"></script>
    @Scripts.Render("~/bundles/fspDispatch")
}

    <div>
        <a class="btn btn-primary" href="~/Assist/Index" target="_blank">Assists</a>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#configModal">Column Configuration</button>
    </div>

<br />

<div class="row">
    <div class="col-sm-3">
        @*new dispatch input form*@
        <div class="panel panel-default">
            <div class="panel-heading">New Dispatch</div>
            <div class="panel-body">
                <form>
                    <div class="form-group">
                        <label for="fspDirection">Direction</label>
                        <input id="fspDirection"
                               class="form-control"
                               tabindex="1"
                               type="text"
                               data-bind="value: fspDirection"
                               maxlength="1"
                               required />
                    </div>
                    <div class="form-group">
                        <label for="fspFreeway">Freeway</label>
                        <input id="fspFreeway"
                               class="form-control"
                               tabindex="2"
                               type="text"
                               data-bind="value: fspFreeway"
                               maxlength="3"
                               required />
                    </div>
                    <div class="form-group">
                        <label for="fspLocation">Location</label>
                        <input id="fspLocation"
                               class="form-control"
                               tabindex="3"
                               type="text"
                               data-bind="value: fspLocation"
                               maxlength="4"
                               required />
                    </div>
                    <div class="form-group">
                        <label for="fspCrossStreet">Cross Street</label>
                        <input id="fspCrossStreet"
                               class="form-control"
                               tabindex="4"
                               type="text"
                               data-bind="value: fspCrossStreet"
                               maxlength="20"
                               required />
                    </div>
                    <div class="form-group" data-bind="visible: fspLocation() === 'BTWN'">
                        <label for="fspCrossStreet2">Cross Street 2</label>
                        <input id="fspCrossStreet2"
                               tabindex="5"
                               type="text"
                               data-bind="value: fspCrossStreet2"
                               maxlength="20" />
                    </div>
                    <div class="form-group">
                        <label for="fspCrossStreet">Comments</label>
                        <textarea id="comments"
                                  class="form-control"
                                  tabindex="5"
                                  data-bind="value: comments"></textarea>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        @*selected trucks*@
        <div class="panel panel-default"
             data-bind="visible: selectedTrucks().length > 0">

            <div class="panel-heading">Selected Trucks</div>

            <div class="panel-body">

                <div class="row">
                    <div class="col-sm-12">
                        <button data-bind="click: doDispatch, disable:!inputIsValid()"
                                type="button"
                                class="btn btn-danger pull-right">
                            Send Trucks (
                            <span data-bind="text: selectedTrucks().length"></span>)
                        </button>
                    </div>
                </div>

                <br />

                <div class="row">
                    <div class="col-sm-12">
                        <table class="table table-striped table-condensed table-bordered">
                            <thead>
                                <tr>
                                    <th>Beat</th>
                                    <th>Truck</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody data-bind="foreach: selectedTrucks">
                                <tr>
                                    <td>
                                        <span data-bind="text: beatNumber()"></span>
                                    </td>
                                    <td>
                                        <span data-bind="text: truckNumber"></span>
                                    </td>
                                    <td>
                                        <button data-bind="click: unSelectTruck"
                                                type="button"
                                                class="btn btn-default pull-right">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>



                @*dispatch summary*@
                <div class="alert alert-info">
                    <div>Dispatch Summary: </div>
                    <div>
                        <span>Heading</span>
                        <b>
                            <span data-bind="text: fspDirection()"></span>
                        </b>
                        <span>on</span>
                        <b>
                            <span data-bind="text: fspFreeway()"></span>
                        </b>
                        <b>
                            <span data-bind="text: fspLocation()"></span>
                        </b>
                        <b>
                            <span data-bind="text: fspCrossStreet()"></span>
                        </b>
                        <b>
                            <span data-bind="text: 'and ' + fspCrossStreet2(), visible: fspCrossStreet2().length > 0"></span>
                        </b>
                        <i data-bind="visible: comments().length > 0">
                            "
                            <span data-bind="text: comments()"></span>"
                        </i>
                    </div>
                </div>
                <div style="display: none">
                    <ul data-bind="foreach: selectedTrucks()"
                        class="list-unstyled">
                        <li>
                            <input type="hidden"
                                   name="SelectedTrucks"
                                   data-bind="value: truckNumber" />
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div>
    @Html.Partial("_TruckStatusList")
</div>

<div>
    @Html.Partial("_TruckListColumnConfig")
</div>

