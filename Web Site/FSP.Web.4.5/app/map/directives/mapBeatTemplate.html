<div ng-show="!isAdding">
   <div class="form-group"
      ng-show="isBusyGetting">
      Loading Beats...
      <i class="fa fa-refresh fa-spin"></i>
   </div>
   <div class="form-group"
      ng-hide="isBusyGetting">
      <select class="form-control"
         ng-model="selectedBeatID"
         ng-change="setSelectedBeat()"
         ng-disabled="beats.length === 0 || isEditing">
         <option value="">
            --Select Beat--
         </option>
         <option ng-repeat="beat in beats"
            value="{{beat.BeatID}}">{{beat.BeatNumber}}</option>
      </select>
   </div>
</div>

<!--input form-->
<form name="pageConfig.beatForm"
   novalidate>
   <div ng-show="selectedBeat"
      class="selectedBeatContainer">
      <div class="form-group"
         ng-class="{'has-error': pageConfig.beatForm.BeatNumber.$invalid}">
         Name *
         <input ng-model="selectedBeat.BeatNumber"
            type="text"
            required
            name="BeatNumber"
            class="form-control"
            ng-disabled="(!isEditing && !isAdding) || isBusySaving" />
      </div>
      <div class="form-group"
         ng-class="{'has-error': pageConfig.beatForm.BeatDescription.$invalid}">
         Description *
         <textarea ng-model="selectedBeat.BeatDescription"
            class="form-control"
            required
            rows="3"
            name="BeatDescription"
            ng-disabled="(!isEditing && !isAdding) || isBusySaving"></textarea>
      </div>
      <div class="form-group">
         Color
         <input type="text"
            minicolors="colorPickerSettings"
            ng-model="selectedBeat.BeatColor"
            class="form-control"
            ng-disabled="(!isEditing && !isAdding) || isBusySaving" />
      </div>
      <div>
         Segments ({{selectedBeat.BeatSegments.length}})
         <button ng-show="isEditing || isAdding"
            ng-click="prepareToAddSegments()"
            class="btn btn-primary btn-sm">
            <i class="fa fa-pencil"></i> Edit Segment List
         </button>
      </div>
   </div>


   <div ng-show="isEditing || isAdding">
      *required fields
   </div>

   <div ng-show="canEdit">
      <!--edit existing-->
      <div class="form-group"
         ng-show="selectedBeat && !isAdding">
         <button ng-hide="isEditing"
            ng-click="setEdit()"
            class="btn btn-primary btn-sm">
            <i class="fa fa-pencil">
            </i> Edit Beat
         </button>
         <button ng-show="isEditing"
            ng-click="save()"
            ng-disabled="isBusySaving || isBusyDeleting || pageConfig.beatForm.$invalid || !selectedBeat.selectedSegmentIds || selectedBeat.selectedSegmentIds.length === 0"
            class="btn btn-primary btn-sm">
            <i class="fa fa-check"
               ng-hide="isBusySaving">
            </i>
            <i class="fa fa-refresh fa-spin"
               ng-show="isBusySaving">
            </i>
            Save
         </button>
         <button ng-show="isEditing"
            ng-disabled="isBusySaving || isBusyDeleting"
            ng-click="delete()"
            class="btn btn-danger btn-sm">
            <i class="fa fa-trash"
               ng-hide="isBusyDeleting">
            </i>
            <i class="fa fa-refresh fa-spin"
               ng-show="isBusyDeleting">
            </i>
            Delete
         </button>
         <button ng-show="isEditing"
            ng-click="cancelEdit()"
            class="btn btn-default btn-sm">
            Cancel
         </button>
      </div>

      <!--add new-->
      <div class="form-group"
         ng-show="!isEditing">
         <button ng-hide="selectedBeat"
            ng-click="prepareNew()"
            class="btn btn-success btn-sm">
            <i class="fa fa-plus"></i> Add Beat
         </button>
         <button ng-show="!isEditing && isAdding"
            ng-click="add()"
            ng-disabled="isBusyAdding || pageConfig.beatForm.$invalid || !selectedBeat.selectedSegmentIds || selectedBeat.selectedSegmentIds.length === 0"
            class="btn btn-success btn-sm">
            <i class="fa fa-check"
               ng-hide="isBusyAdding">
            </i>
            <i class="fa fa-refresh fa-spin"
               ng-show="isBusyAdding">
            </i>
            Save
         </button>
         <button ng-show="!isEditing && isAdding"
            ng-click="cancelAdd()"
            class="btn btn-default btn-sm">
            Cancel
         </button>
      </div>
   </div>

</form>


<div class="modal fade"
   id="segmentPickerModal"
   tabindex="-1"
   role="dialog">

   <div class="modal-dialog"
      role="document">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button"
               class="close"
               data-dismiss="modal"
               aria-label="Close">
               <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title"
               id="myModalLabel">
               Add Segments
            </h4>
         </div>
         <div class="modal-body">
            <segment-picker selected-beat="selectedBeat"
               all-segments="allSegments"></segment-picker>
            <!-- <div class="segmentPickerList">
               <input type="text"
                  ng-model="segmentNameFilter"
                  class="form-control"
                  placeholder="Type to filter" />
               <br>
               <div class="checkbox checkbox-slider--b-flat"
                  ng-repeat="segment in allSegments|filter:segmentNameFilter">
                  <label>
                     <input type="checkbox"
                        checklist-model="selectedSegmentIds"
                        checklist-value="segment.BeatSegmentID" /><span>{{segment.BeatSegmentNumber}}</span>
                  </label>
               </div>
            </div> -->
         </div>
         <div class="modal-footer">
            <button type="button"
               class="btn btn-default pull-left"
               data-dismiss="modal">
               Cancel
            </button>
            <button type="button"
               ng-click="saveSelectedSegments()"
               class="btn btn-primary">
               Confirm
            </button>
         </div>
      </div>
   </div>
</div>